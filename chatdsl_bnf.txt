<chatybot-dsl> ::= <command> | <script>

<script> ::= { <script-line> }

<script-line> ::= ( <command> | <comment> | <empty-line> ) <newline>

<command> ::= <escape-command> | <script-command> | <chat-input>

<escape-command> ::= "/" <escape-command-name> [ <whitespace> <escape-command-args> ]

<escape-command-name> ::= "help" | "prompt" | "file" | "showfile" | "clearfile" | 
                          "filebank" <digit_1_5> | "model" | "listmodels" | "logging" | 
                          "save" | "codeonly" | "codeoff" | "multiline" | "system" | 
                          "temp" | "maxtokens" | "stream" | "script" | "quit"

<script-command> ::= <set-command> | <wait-command> | <if-command>

<set-command> ::= "set" <whitespace> <variable-name> <whitespace> "=" <whitespace> <variable-value>

<wait-command> ::= "wait" <whitespace> <number>

<if-command> ::= "if" <whitespace> <condition> <whitespace> "then" <whitespace> ( <escape-command> | <script-command> | <chat-input> )

<chat-input> ::= <single-line-text> | <multiline-block>

<multiline-block> ::= "/multiline" <newline> { <text-content> <newline> } ";;"

<text-content> ::= { <any-character> | <variable-reference> | <filebank-reference> }

<variable-reference> ::= "${" <variable-name> "}"

<filebank-reference> ::= "{" "filebank" <digit_1_5> "}"

<variable-name> ::= <identifier>
<variable-value> ::= <string> | <number> | "true" | "false" | "yes" | "no"
<digit_1_5> ::= "1" | "2" | "3" | "4" | "5"
<newline> ::= "\n"
<whitespace> ::= " " | "\t"
